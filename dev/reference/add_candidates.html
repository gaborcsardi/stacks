<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Add model definitions to a data stack — add_candidates • stacks</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="../tidyverse.css" rel="stylesheet"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><link href="../tidyverse-2.css" rel="stylesheet"><!--optional theme--><link href="../tidymodels.css" rel="stylesheet"><meta property="og:title" content="Add model definitions to a data stack — add_candidates"><meta property="og:description" content="add_candidates() collates the assessment set predictions
and additional attributes from the supplied model definition
(i.e. set of &quot;candidates&quot;) to a data stack.
Behind the scenes, data stack objects are just tibble::tbl_dfs,
where the first column gives the true response values,
and the remaining columns give the assessment set predictions
for each candidate. In the regression setting, there's only
one column per ensemble member. In classification settings,
there are as many columns per candidate ensemble member
as there are levels of the outcome variable.
To initialize a data stack, use the stacks() function.
Model definitions are appended to a data stack iteratively
using several calls to add_candidates(). Data stacks are
evaluated using the blend_predictions() function."><meta property="og:image" content="https://stacks.tidymodels.org/logo.png"><meta name="twitter:card" content="summary"><meta name="robots" content="noindex"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-115082821-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-115082821-1');
</script></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      <div class="navbar-brand-container">
        <a class="navbar-brand" href="../index.html">stacks</a>
        <div class="info hidden-xs hidden-sm">
          <span class="partof">part of <a href="https://github.com/tidymodels" class="external-link">tidymodels</a></span>
          <span class="version version-danger" data-toggle="tooltip" data-placement="bottom" title="In-development version">0.2.2.9000</span>
        </div>
      </div>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav navbar-right"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/basics.html">Getting Started With stacks</a>
    </li>
    <li>
      <a href="../articles/classification.html">Classification Models With stacks</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
        <li>
  <a href="https://github.com/tidymodels/stacks/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Add model definitions to a data stack</h1>
    <small class="dont-index">Source: <a href="https://github.com/tidymodels/stacks/blob/HEAD/R/add_candidates.R" class="external-link"><code>R/add_candidates.R</code></a></small>
    <div class="hidden name"><code>add_candidates.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>add_candidates()</code> collates the assessment set predictions
and additional attributes from the supplied model definition
(i.e. set of "candidates") to a data stack.</p>
<p>Behind the scenes, data stack objects are just <a href="https://tibble.tidyverse.org/reference/tbl_df-class.html" class="external-link">tibble::tbl_df</a>s,
where the first column gives the true response values,
and the remaining columns give the assessment set predictions
for each candidate. In the regression setting, there's only
one column per ensemble member. In classification settings,
there are as many columns per candidate ensemble member
as there are levels of the outcome variable.</p>
<p>To initialize a data stack, use the <code><a href="stacks.html">stacks()</a></code> function.
Model definitions are appended to a data stack iteratively
using several calls to <code>add_candidates()</code>. Data stacks are
evaluated using the <code><a href="blend_predictions.html">blend_predictions()</a></code> function.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">add_candidates</span><span class="op">(</span>
  <span class="va">data_stack</span>,
  <span class="va">candidates</span>,
  name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/deparse.html" class="external-link">deparse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/substitute.html" class="external-link">substitute</a></span><span class="op">(</span><span class="va">candidates</span><span class="op">)</span><span class="op">)</span>,
  <span class="va">...</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>data_stack</dt>
<dd><p>A <code>data_stack</code> object.</p></dd>
<dt>candidates</dt>
<dd><p>A model definition: either a <code>tune_results</code>
or <code>resample_results</code> object outputted from
<code><a href="https://tune.tidymodels.org/reference/tune_grid.html" class="external-link">tune::tune_grid()</a></code>, <code><a href="https://tune.tidymodels.org/reference/tune_bayes.html" class="external-link">tune::tune_bayes()</a></code>, or <code><a href="https://tune.tidymodels.org/reference/fit_resamples.html" class="external-link">tune::fit_resamples()</a></code>.
These results must have been fitted with the <code>control</code> settings
<code>save_pred = TRUE, save_workflow = TRUE</code>—see the <code><a href="control_stack.html">control_stack_grid()</a></code>,
<code><a href="control_stack.html">control_stack_bayes()</a></code>, and <code><a href="control_stack.html">control_stack_resamples()</a></code>
documentation for helper functions.</p></dd>
<dt>name</dt>
<dd><p>The label for the model definition---defaults to the name
of the <code>candidates</code> object.</p></dd>
<dt>...</dt>
<dd><p>Additional arguments. Currently ignored.</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A <code>data_stack</code> object--see <code><a href="stacks.html">stacks()</a></code> for more details!</p>
    </div>
    <div id="example-data">
    <h2>Example Data</h2>
    


<p>This package provides some resampling objects and datasets for use in examples
and vignettes derived from a study on 1212 red-eyed tree frog embryos!</p>
<p>Red-eyed tree frog (RETF) embryos can hatch earlier than their normal
7ish days if they detect potential predator threat. Researchers wanted
to determine how, and when, these tree frog embryos were able to detect
stimulus from their environment. To do so, they subjected the embryos
at varying developmental stages to "predator stimulus" by jiggling
the embryos with a blunt probe. Beforehand, though some of the embryos
were treated with gentamicin, a compound that knocks out their lateral
line (a sensory organ.) Researcher Julie Jung and her crew found that
these factors inform whether an embryo hatches prematurely or not!</p>
<p>Note that the data included with the stacks package is not necessarily
a representative or unbiased subset of the complete dataset, and is
only for demonstrative purposes.</p>
<p><code>reg_folds</code> and <code>class_folds</code> are <code>rset</code> cross-fold validation objects
from <code>rsample</code>, splitting the training data into for the regression
and classification model objects, respectively. <code>tree_frogs_reg_test</code> and
<code>tree_frogs_class_test</code> are the analogous testing sets.</p>
<p><code>reg_res_lr</code>, <code>reg_res_svm</code>, and <code>reg_res_sp</code> contain regression tuning results
for a linear regression, support vector machine, and spline model, respectively,
fitting <code>latency</code> (i.e. how long the embryos took to hatch in response
to the jiggle) in the <code>tree_frogs</code> data, using most all of the other
variables as predictors. Note that the data underlying these models is
filtered to include data only from embryos that hatched in response to
the stimulus.</p>
<p><code>class_res_rf</code> and <code>class_res_nn</code> contain multiclass classification tuning
results for a random forest and neural network classification model,
respectively, fitting <code>reflex</code> (a measure of ear function) in the
data using most all of the other variables as predictors.</p>
<p><code>log_res_rf</code> and <code>log_res_nn</code>, contain binary classification tuning results
for a random forest and neural network classification model, respectively,
fitting <code>hatched</code> (whether or not the embryos hatched in response
to the stimulus) using most all of the other variables as predictors.</p>
<p>See <code><a href="example_data.html">?example_data</a></code> to learn more about these objects, as well as browse
the source code that generated them.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p>Other core verbs: 
<code><a href="blend_predictions.html">blend_predictions</a>()</code>,
<code><a href="fit_members.html">fit_members</a>()</code>,
<code><a href="stacks.html">stacks</a>()</code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="co"># \donttest{</span></span>
<span class="r-in"><span class="co"># see the "Example Data" section above for</span></span>
<span class="r-in"><span class="co"># clarification on the objects used in these examples!</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># put together a data stack using</span></span>
<span class="r-in"><span class="co"># tuning results for regression models</span></span>
<span class="r-in"><span class="va">reg_st</span> <span class="op">&lt;-</span> </span>
<span class="r-in">  <span class="fu"><a href="stacks.html">stacks</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span class="r-in">  <span class="fu">add_candidates</span><span class="op">(</span><span class="va">reg_res_lr</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span class="r-in">  <span class="fu">add_candidates</span><span class="op">(</span><span class="va">reg_res_svm</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span class="r-in">  <span class="fu">add_candidates</span><span class="op">(</span><span class="va">reg_res_sp</span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Registered S3 method overwritten by 'tune':</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   method                   from   </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   required_pkgs.model_spec parsnip</span>
<span class="r-in">  </span>
<span class="r-in"><span class="va">reg_st</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # A data stack with 3 model definitions and 16 candidate members:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> #   reg_res_lr: 1 model configuration</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> #   reg_res_svm: 5 model configurations</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> #   reg_res_sp: 10 model configurations</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # Outcome: latency (numeric)</span>
<span class="r-in">  </span>
<span class="r-in"><span class="co"># do the same with multinomial classification models</span></span>
<span class="r-in"><span class="va">class_st</span> <span class="op">&lt;-</span></span>
<span class="r-in">  <span class="fu"><a href="stacks.html">stacks</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span class="r-in">  <span class="fu">add_candidates</span><span class="op">(</span><span class="va">class_res_nn</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span class="r-in">  <span class="fu">add_candidates</span><span class="op">(</span><span class="va">class_res_rf</span><span class="op">)</span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span><span style="color: #BBBB00;">Predictions from 1 candidate were identical to those from existing</span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> * <span style="color: #BBBB00;">candidates and were removed from the data stack.</span></span>
<span class="r-in">  </span>
<span class="r-in"><span class="va">class_st</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # A data stack with 2 model definitions and 10.6666666666667 candidate members:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> #   class_res_nn: 1 model configuration</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> #   class_res_rf: 9.66666666666667 model configurations</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # Outcome: reflex (factor)</span>
<span class="r-in">  </span>
<span class="r-in"><span class="co"># ...or binomial classification models</span></span>
<span class="r-in"><span class="va">log_st</span> <span class="op">&lt;-</span></span>
<span class="r-in">  <span class="fu"><a href="stacks.html">stacks</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span class="r-in">  <span class="fu">add_candidates</span><span class="op">(</span><span class="va">log_res_nn</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span class="r-in">  <span class="fu">add_candidates</span><span class="op">(</span><span class="va">log_res_rf</span><span class="op">)</span></span>
<span class="r-in">  </span>
<span class="r-in"><span class="va">log_st</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # A data stack with 2 model definitions and 11 candidate members:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> #   log_res_nn: 1 model configuration</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> #   log_res_rf: 10 model configurations</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # Outcome: hatched (factor)</span>
<span class="r-in">  </span>
<span class="r-in"><span class="co"># use custom names for each model:</span></span>
<span class="r-in"><span class="va">log_st2</span> <span class="op">&lt;-</span></span>
<span class="r-in">  <span class="fu"><a href="stacks.html">stacks</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span class="r-in">  <span class="fu">add_candidates</span><span class="op">(</span><span class="va">log_res_nn</span>, name <span class="op">=</span> <span class="st">"neural_network"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span class="r-in">  <span class="fu">add_candidates</span><span class="op">(</span><span class="va">log_res_rf</span>, name <span class="op">=</span> <span class="st">"random_forest"</span><span class="op">)</span></span>
<span class="r-in">  </span>
<span class="r-in"><span class="va">log_st2</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # A data stack with 2 model definitions and 11 candidate members:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> #   neural_network: 1 model configuration</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> #   random_forest: 10 model configurations</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # Outcome: hatched (factor)</span>
<span class="r-in">  </span>
<span class="r-in"><span class="co"># these objects would likely then be</span></span>
<span class="r-in"><span class="co"># passed to blend_predictions():</span></span>
<span class="r-in"><span class="va">log_st2</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="blend_predictions.html">blend_predictions</a></span><span class="op">(</span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ── A stacked ensemble model ─────────────────────────────────────</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Out of 11 possible candidate members, the ensemble retained 3.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Penalty: 1e-05.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Mixture: 1.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The 3 highest weighted member classes are:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 3 × 3</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   member                       type        weight</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> .pred_yes_neural_network_1_1 mlp          7.44 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span> .pred_yes_random_forest_1_05 rand_forest  3.34 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span> .pred_yes_random_forest_1_09 rand_forest  0.150</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Members have not yet been fitted with `fit_members()`.</span>
<span class="r-in"><span class="co"># }</span></span>
<span class="r-in"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="tidyverse">
  <p>stacks is a part of the <strong>tidymodels</strong> ecosystem, a collection of modeling packages designed with common APIs and a shared philosophy.</p>
</div>

<div class="author">
  <p>
    Developed by .
    Site built by <a href="https://pkgdown.r-lib.org" class="external-link">pkgdown</a>.
  </p>
</div>

      </footer></div>

  


  

  </body></html>

